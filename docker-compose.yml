version: '3.8'

services:
  # MaiBot 核心 (使用官方镜像，无需自己构建)
  core:
    container_name: maim-bot-core
    image: sengokucola/maibot:latest
    restart: always
    environment:
      - TZ=Asia/Shanghai
    ports:
      - "8001:8001" # webui端口
      - "8090:8090" # OneBot 监听端口 (供 Koishi 连接)
    volumes:
      # 映射配置文件
      - ./config:/MaiMBot/config 
      # 映射数据目录
      - ./data/MaiMBot:/MaiMBot/data
      - ./logs:/MaiMBot/logs
    networks:
      - maim_bot

  # Koishi (Telegram 桥接器) - 替代了官方里的 NapCat (QQ)
  koishi:
    image: koishijs/koishi
    container_name: maim-bot-koishi
    restart: always
    ports:
      - "5140:5140" # Koishi 控制台
    volumes:
      - ./koishi-data:/koishi
    environment:
      - TZ=Asia/Shanghai
    networks:
      - maim_bot

  # 数据库管理工具 (可选，保留官方配置)
  sqlite-web:
    image: coleifer/sqlite-web
    container_name: sqlite-web
    restart: always
    ports:
      - "8120:8080"
    volumes:
      - ./data/MaiMBot:/data/MaiMBot
    environment:
      - SQLITE_DATABASE=/data/MaiMBot/MaiBot.db
    networks:
      - maim_bot

networks:
  maim_bot:
    driver: bridge
